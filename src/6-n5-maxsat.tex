\newgeometry{top=2cm,bottom=2cm,left=3cm,right=1.5cm,nohead,includeheadfoot}

\section{Разбор 5-переменных}
\label{sec:n5}

\subsection{Общие наблюдения}
\label{subsec:n5:observations}

Итак, после того, как правило расщепления \ref{brule:measure:sixplus} неприменимо, остался экземпляр задачи $(n,5)$-MAXSAT. В данном разделе представлен разбор случаев, в совокупности позволяющих избавиться от 5-переменных. Прежде всего, несколько наблюдений.

Во-первых, не умаляя общности, 5-переменная может быть $(4,1)$-переменной или $(3,2)$-переменной. В силу правила сокращения \ref{rrule:common:unit-clauses}, в первом случае переменная может встречаться в дизъюнктах длины 1 лишь отрицательно, во втором случае -- либо дважды отрицательно, либо однажды положительно или отрицательно. Каждый из этих случаев разобран в разделах этой главы.

Во-вторых, вспомним доказательство леммы \ref{lemma:measure:branch-on}. В доказательстве изменение уменьшенной длины формулы считалось как сумма изменений весов всех переменных. Для 5-переменных оказывается, что случаев переменных-соседей немного. Все эти случаи приведены в таблице \ref{table:n5:varcases}. В первом столбце перечислено количество вхождений во всю формулу. Во втором столбце перечислено изменение длины до применения правил сокращения, то есть количество литералов этой переменной, которые могут одновременно иметь соседями один и тот же литерал переменной, по которой мы пытаемся расщепиться. В третьем столбце приведено изменение веса этой переменной в уменьшенной длине в таком случае.

\begin{table}[ht]
 \centering
 \caption{Случаи переменных-соседей для $(n,5)$-MAXSAT}
 \begin{tabular}{|c|c|c|}
  \hline
  Тип переменной & $\Delta L$ & $\Delta d$ \\
  \hline\hline
  \multirow{2}{*}{3-переменная}
                 & 1          & 2 \\
                 & 2          & 2 \\
  \hline
  \multirow{4}{*}{4-переменная}
                 & 1          & 2 \\
                 & 2          & 4 \\
                 & 3          & 4 \\
                 & 4          & 4 \\
  \hline
  \multirow{4}{*}{5-переменная}
                 & 1          & 1 \\
                 & 2          & 3 \\
                 & 3          & 5 \\
                 & 4          & 5 \\
  \hline
 \end{tabular}
 \label{table:n5:varcases}
\end{table}

В таблице отсутствуют 3-переменные, встречающиеся среди соседей такой переменной трижды, поскольку, как указано в доказательстве леммы \ref{lemma:measure:branch-on}, правило сокращения \ref{rrule:common:xu19rr9} позволяет сократить такие случаи. Также в таблице не указаны 5-переменные, встречающиеся пятикратно, так как пять литералов такой переменной должны были бы иметь соседями один и тот же литерал, что невозможно, поскольку в силу правила сокращения \ref{rrule:common:i0} в $(n,5)$-MAXSAT формуле каждый литерал встречается не более чем четырежды.

Лемма \ref{lemma:measure:branch-on} фактически утверждает, что $\Delta L \leq \Delta d$. Для $(n,5)$-MAXSAT можно заметить к тому же, что почти во всех строках $\Delta L < \Delta d$. Равенство достигается лишь для 3-переменных, встречающихся дважды, 4-переменных, встречающихся четырежды, или 5-переменных, встречающихся однажды. Более того, второй из этих трёх случаев встречается только при разборе $(4,1)$-переменных, но не при разборе $(3,2)$-переменных.

Таким образом, верно неформальное усиление леммы \ref{lemma:measure:branch-on}: если среди соседей есть переменные, не являющиеся одним из этих трёх (а после разбора $(4,1)$-переменных двух) случаев, то уменьшенная мера уменьшается даже больше, чем длина. Это позволяет строить эффективные правила расщепления для 5-переменных.

Такое утверждение позволяет разобрать огромное количество крайних случаев. В общем же случае может оказаться, что все соседи какой-то переменной -- 5-переменные, встречающиеся там однажды. В таком случае можно этим воспользоваться и вывести правило расщепления, означивающее одновременно многих соседей. Это правило формально закреплено в двух следующих леммах.

\begin{lemma}
 Пусть $x$ -- $(3,2)$-переменная следующего вида:

 $$
  (x \vee C_1) \wedge (x \vee C_2) \wedge (x \vee C_3) \wedge (\ovl{x} \vee D_1) \wedge (\ovl{x} \vee D_2) \wedge F'
 $$

 Пусть при этом $|C_1| = 1$, а $C_2$ и $C_3$ непусты. Тогда, если существует означивание переменных, одновременно выполняющее $C_2$ и $C_3$ и не выполняющее $C_1$, $D_1$ и $D_2$, расщепление на следующие три случая корректно:

 \begin{enumerate}
  \item $x = 1$
  \item $x = 0$, $C_1 = 1$
  \item $x = 0$, $C_1 = 0$, $C_2 = C_3 = 1$, и, если для какого-то $i$ дизъюнкт $D_i$ непуст, $D_i = 0$
 \end{enumerate}

 \label{lemma:n5:3-cases}
\end{lemma}

\begin{proof}
 Во-первых, докажем, что существует оптимальное означивание, в котором или $x$ равен единице, или два из трёх дизъюнктов $C_i$ выполнены.

 Рассмотрим какое-то оптимальное означивание. Пусть в нём $x = 0$ и из $C_i$ выполнено не более одного дизъюнкта. Тогда всего из дизъюнктов, в которых встречается $x$, выполнено не более трёх. Означив в таком случае $x = 1$, мы из этих пяти дизъюнктов выполним хотя бы столько же, и не изменим значения других дизъюнктов.

 Более того, если в оптимальном означивании хотя бы один из $D_i$ равен единице, то утверждение усиливается до ``все $C_i$ должны быть выполнены'' в силу того, что означивание $x = 1$ выполняет хотя бы четыре из пяти дизъюнктов.

 Таким образом, существует оптимальное означивание, в котором выполняется одно из трёх утверждений: либо $x = 1$, либо $x = 0$ и $C_1 = 1$, либо, если $x = 0$ и $C_1 = 0$, то $C_2$ и $C_3$ равны единице. Более того, поскольку в последнем случае выполняются два из трёх $C_i$, в таком случае обязательно все непустые $D_i$ равны нулю.
\end{proof}

\begin{lemma}
 Пусть $x$ -- $(3,2)$-переменная такого же вида, как в лемме \ref{lemma:n5:3-cases}, где $|C_1| = 1$, а $C_2$ и $C_3$ непусты. Пусть при этом не существует означивания переменных, одновременно выполняющего $C_2$ и $C_3$ и не выполняющего $C_1$, $D_1$ и $D_2$. Тогда расщепление на следующие три случая корректно:

 \begin{enumerate}
  \item $x = 1$
  \item $x = 0$, $C_1 = 1$
 \end{enumerate}
 \label{lemma:n5:2-cases}
\end{lemma}

\begin{proof}
 В лемме \ref{lemma:n5:3-cases} доказано, что существует оптимальное означивание переменных, удовлетворяющее одному из трёх случаев. В данной лемме дополнительно в условиях указана невозможность существования означивания, удовлетворяющего третьему из них. Значит, остаются первые два.
\end{proof}

Как показано ниже, двух правил расщепления из лемм \ref{lemma:n5:3-cases} и \ref{lemma:n5:2-cases} в совокупности с расщеплением по переменным и несколькими правилами сокращения оказывается достаточно.

\subsection{Разбор $(4,1)$-переменных}
\label{subsec:n5:41}

В первую очередь докажем общее правило расщепления для $(i,1)$-переменных.

\begin{lemma}
 Пусть $x$ -- $(i,1)$-переменная ($i \geq 2$) в формуле вида

 $$
  (x \vee C_1) \wedge \ldots \wedge (x \vee C_i) \wedge (\ovl{x} \vee D) \wedge F'
 $$

 Тогда расщепление на следующие два случая корректно:
 \begin{enumerate}
  \item $x = 1$
  \item $x = 0$, если $D$ непусто, $D = 0$, и, если для какого-то $j$ выполняется $|C_j| = 1$, то $C_j = 1$
 \end{enumerate}
 \label{lemma:n5:i1}
\end{lemma}

\begin{proof}
 Покажем, что существует оптимальное означивание, в котором либо $x = 1$, либо $x = 0$ и тогда все $C_j$ выполнены, а $D$ не выполнено.

 Рассмотрим какое-то оптимальное означивание. Пусть в нём $x = 0$, но один из $C_j$ не выполнен. Тогда из всех дизъюнктов, содержащих $x$, выполнены не более $i$. Тогда при означивании $x = 1$ из этих дизъюнктов будет выполнено хотя бы $i$, а значения других дизъюнктов не изменяются. Таким образом, мы получили оптимальное означивание, в котором $x = 1$.

 Теперь пусть в оптимальном означивании $x = 0$ и все $C_j$ выполнены, но также выполнен $D$. Тогда при означивании $x = 1$ выполнимость ни одного дизъюнкта не изменится. Таким образом, мы снова получили оптимальное означивание, в котором $x = 1$.
\end{proof}

Мы обозначим $(4,1)$-переменную $x$ также, как в формулировке леммы \ref{lemma:n5:i1}:

$$
 (x \vee C_1) \wedge (x \vee C_2) \wedge (x \vee C_3) \wedge (x \vee C_4)
$$

Здесь, как указано выше, все $C_i$ непусты, а $D$ может быть пустым.

Воспользуемся только что доказанной леммой.

\begin{brule}
 Если $x$ -- $(4,1)$-переменная, расщепиться по правилу из леммы \ref{lemma:n5:i1}.

 Это даёт как минимум $(7,9)$-расщепление.
 \label{brule:n5:41}
\end{brule}

\begin{proof}
 Во-первых, если $|D| > 0$, это хотя бы $(7,9)$-расщепление. В первом случае длина уменьшается хотя бы на 9 (пять литералов $x$ и как минимум четыре литерала в $C_j$), а значит, по лемме \ref{lemma:measure:branch-on}, уменьшенная длина уменьшается хотя бы на 9. Во втором случае мы убираем 5-переменную $x$ и $3^+$-переменную из $D$, таким образом уменьшая меру $d$ как минимум на 7.

 Во-вторых, если $|D| = 0$, но существует такое $j$, что $|C_j| = 1$, то это точно также хотя бы $(7,9)$-расщепление: во втором случае мы убираем переменную не из $D$, а из $C_j$, а в остальном доказательство повторяет предыдущий абзац.

 Наконец, если $|D| = 0$ и все $|C_j| > 1$, то $\sum_j |C_j| \geq 8$. Тогда по лемме \ref{lemma:measure:branch-on} это хотя бы $(5,13)$-расщепление.

 Так как вектор $(7,9)$ хуже, он и является оценкой для худшего случая.
\end{proof}

После того, как указанное правило неприменимо, в формуле не осталось $(4,1)$-переменных.

% vim: spell spelllang=ru_yo,en_gb
