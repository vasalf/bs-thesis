\newgeometry{top=2cm,bottom=2cm,left=3cm,right=1.5cm,nohead,includeheadfoot}

\section{Уменьшенная мера}
\label{sec:measure}

\subsection{Мотивация}
\label{subsec:measure:motivation}

\firstpar{}При разработке алгоритма для задачи $(n,4)$-MAXSAT становится заметным дисбаланс между 3-переменными и 4-переменными: при относительно небольшой разнице в стоимости этих переменных в мере длины свойства этих переменных заметно различаются. Эта разница заключается в следующем.

Введённые ранее правила упрощения \ref{rrule:common:i0} и \ref{rrule:common:resolution} позволяют избавляться от $2^-$-переменных. Значит, при удалении одного литерала у 3-переменной моментально элиминируются и два других литерала. Благодаря этому и достигается время работы алгоритма для задачи $(n,3)$-MAXSAT, значительно меньшее времени работы в общем случае.

В то же время, удаление одного литерала 4-переменной делает из неё 3-переменную. Для полной элиминации 4-переменной необходимо удалить из неё как минимум два литерала.

В работе \cite{bansal99}, представляющей лучший до сих пор алгоритм для общего случая задачи о максимальной выполнимости, одним из худших случаев является случай с 4-переменной с большим количеством соседей, также являющихся 4-переменными. Хотя небольшое улучшение получить в этом случае возможно, разбор такого случая до целей, поставленных в этой работе, всё ещё представляет сложность.

Уменьшенный параметр, введённый ниже, позволяет бороться с этим дисбалансом. Практика показывает, что он оказывается также полезным для переменных с бóльшим количеством вхождений в формулу.

\subsection{Определение}
\label{subsec:measure:definition}

\begin{definition}
 Уменьшенной мерой формулы $F$ называется величина $d = L - n_3$.
\end{definition}

Поскольку $n_3$ является неотрицательной величиной, для любой формулы $d \leq L$. Таким образом, любой алгоритм, работающий за $O^*(\alpha^d)$, автоматически работает за $O^*(\alpha^L)$. Следовательно, достаточно существования алгоритма за $O^*(\alpha^d)$. В дальнейшем в работе строится алгоритм относительно именно уменьшенной меры.

Отметим, что такую меру можно записать в следующем виде:

\begin{gather}
 d = L - n_3 = \sum_{k \geq 3} kn_k - n_3 = 2n_3 + \sum_{k \geq 4} kn_k
 \label{formula:discounted-length}
\end{gather}

Для задач $(n,4)$-MAXSAT и $(n,5)$-MAXSAT эта запись имеет вид $d = 2n_3 + 4n_4$ и $d = 2n_3 + 4n_4 + 5n_5$, соответственно. В частности, для мотивации, представленной в разделе \ref{subsec:measure:motivation}, видно, что при удалении одного литерала у 4-переменной эта мера уменьшается на 2, то есть на столько же, на сколько она уменьшается при удалении одного литерала у 3-переменной. Таким образом, происходит выравнивание свойств 3- и 4-переменных и становится возможным придумать для 4-переменных правила расщепления с временем работы, почти не отличающимся от времени работы алгоритма для $(n,3)$-MAXSAT относительно этой меры.

Касательно последнего, в статье Беловой и Близнеца \cite{belova18} указана асимптотика получившегося алгоритма $O^*(1.191^{n_3})$, что соответствует времени $O^*(1.0912^{2n_3}) = O^*(1.0912^d)$. В статье худшим вектором расщепления указан вектор $(2,7)$, соответствующий, в терминах $d$, вектору $(4,14)$.

\subsection{Свойства}
\label{subsec:measure:properties}

\firstpar{}Важнейшим свойством уменьшенной таким образом меры является то, что в очень многих случаях правила расщепления дают не худший вектор расщепления, чем в мере длины. В частности, такое можно доказать для обычного расщепления по переменной. Это и является утверждением леммы \ref{lemma:measure:branch-on}.

\begin{lemma}
 Пусть $x$ -- $(i,j)$-переменная ($i + j \geq 4$) в несократимой формуле

 $$
  F =
  (x \vee C_1) \wedge
  \ldots \wedge
  (x \vee C_i) \wedge
  (\ovl{x} \vee D_1) \wedge
  \ldots \wedge
  (\ovl{x} \vee D_j) \wedge
  F'
 $$

 Тогда расщепление по переменной $x$ даёт относительно меры $d$ вектор расщепления не хуже, чем $(i + j + \sum\limits_{k=1}^i |C_k|, i + j + \sum\limits_{k=1}^j |D_k|)$.
 \label{lemma:measure:branch-on}
\end{lemma}

\begin{proof}
 В случае $x = 1$ из формулы убираются все отрицательные вхождения $x$ (как ложные они не влияют на выполнение дизъюнктов, в которые они входят) и все дизъюнкты с положительным вхождением $x$ (как уже выполненные). Аналогично, в случае $x = 0$ из формулы убираются все положительные вхождения $x$ и все дизъюнкты с отрицательным вхождением $x$. Таким образом, нашей задачей является доказать, что уменьшенная мера после применения правил упрощения изменяется не меньше, чем длина формулы до применения этих правил.

 В первую очередь, отметим, что никакие правила упрощения, введённые до текущего момента или после, не вводят новых переменных, но лишь убирают литералы существующих или же склеивают дизъюнкты (как правило \ref{rrule:common:resolution}) или иногда добавляют новые литералы, уменьшая при этом их общее количество (такие как правило \ref{rrule:common:xu19rr9}). Таким образом, разницу уменьшенных мер формул можно посчитать как сумму разниц весов переменных в этих формулах.

 В мере длины за каждый элиминированный литерал мера уменьшается на 1.

 В уменьшенной мере за каждый элиминированный литерал $4^+$-переменной длина уменьшается хотя бы на 1. При сведении же $4^+$-переменной к $2^-$-переменной полученная переменная моментально элиминируется правилами \ref{rrule:common:resolution} или \ref{rrule:common:i0}. Таким образом, уменьшение числа литералов $k$-переменной на $t$ уменьшает вес переменной хотя бы на $t$, достигая значения $t$ при $t \leq k - 4$ или $t = k$.

 Таким образом, для $4^+$-переменных уменьшение веса в уменьшенной меры не меньше уменьшения веса в длине формулы. Поскольку $x$ из условия леммы является $4^+$-переменной, сказанное относится и к нему.

 Остался случай 3-переменных. Для них при уменьшении количества литералов вес всегда уменьшается на 2, но в случае элиминации всех литералов у такой переменной длина изменяется на 3. Однако, если все три литерала входили в дизъюнкты $C_i$ или $D_i$, то к такой 3-переменной применимо правило упрощения \ref{rrule:common:xu19rr9}. Такого быть не могло, а значит, у 3-переменных не могло элиминироваться больше двух литералов.

 Таким образом, в каждом из случаев уменьшенная мера изменяется после применения правил упрощения не меньше, чем длина до применения этих правил, что и требовалось доказать.
\end{proof}

Оказывается, этого утверждения, вместе с объявленными выше правилами упрощения, достаточно для разбора $6^+$-переменных.

\begin{brule}
 Если в формуле есть $6^+$-переменная $x$, расщепиться по ней.

 Это даёт как минимум $(6,10)$-расщепление.
 \label{brule:measure:sixplus}
\end{brule}

\begin{proof}
 Основная идея — доказать, что переменная входит в небольшое количество дизъюнктов длины 1, и воспользоваться леммой \ref{lemma:measure:branch-on}.

 Пусть $x$ -- $(i,j)$-переменная (не умаляя общности, $i \geq j$). Во-первых, в силу правила упрощения \ref{rrule:common:almost-common}, лишь один из литералов $x$ и $\ovl{x}$ может входить в дизъюнкты длины 1. Соответственно, рассмотрим два случая: когда $x$ входит в дизъюнкты длины 1 и когда не входит.

 Если $x$ входит в дизъюнкты длины 1, то в силу правила упрощения \ref{rrule:common:unit-clauses} таких дизъюнктов может быть не более $j - 1$, и, таким образом, по лемме \ref{lemma:measure:branch-on} вектор расщепления у нас как минимум $(2(i - j + 1) + j - 1 + j, 2j + i) = (2i + 1, 2j + i)$.

 Если $x$ не входит в дизъюнкты длины 1, то лемма \ref{lemma:measure:branch-on} даёт расщепление хотя бы $(2i + j, i + j)$. Более того, в случае $i = j$ в силу правила упрощения \ref{rrule:common:unit-clauses} все вхождения литерала $\ovl{x}$ не могут быть в дизъюнктах длины 1. Следовательно, в случае $i = j$ у нас вектор расщепления не хуже, чем $(3i, 2i + 1)$.

 Если переменная является $8^+$-переменной, расщепление по ней даёт вектор как минимум $(8,8)$ (по восемь литералов такой переменной элиминируются в каждом случае). Такой вектор уже лучше вектора $(6,10)$.

 Для 6-переменных и 7-переменных вектора, полученные оценками выше, можно найти в таблице \ref{table:sixplus}.

 \begin{table}[ht]
  \centering
  \caption{Оценочные вектора расщепления для 6- и 7-переменных}
  \begin{tabular}{|c|c|c|c|c|}
   \hline
   \multirow{2}{*}{$(i,j)$} & \multicolumn{2}{|c|}{Первый случай} & \multicolumn{2}{|c|}{Второй случай} \\
   \cline{2-5}
                            & Вектор & Число                      & Вектор & Число \\
   \hline
   $(6,1)$ & $(13,8)$ & 1.0697 & $(13,7)$ & 1.0743 \\
   $(5,2)$ & $(11,9)$ & 1.0721 & $(12,7)$ & 1.0777 \\
   $(4,3)$ & $(9,10)$ & 1.0758 & $(11,7)$ & 1.0816 \\
   \hline
   $(5,1)$ & $(11,7)$ & 1.0816 & $(11,6)$ & 1.0878 \\
   $(4,2)$ & $(9,8)$  & 1.0851 & $(10,6)$ & 1.0927 \\
   $(3,3)$ & $(7,9)$  & 1.0911 & $(9,7)$  & 1.0911 \\
   \hline
  \end{tabular}
  \label{table:sixplus}
 \end{table}

Отметим, что второй подслучай второго случая возникает в таблице лишь для $(3,3)$-переменных

Видно, что в таблице худшим вектором является вектор $(6,10)$ во втором случае для $(4,2)$-переменных. Таким образом, он же является худшим и для всех $6^+$-переменных.
\end{proof}

Хочется заметить, что такое утверждение верно и для длины формулы, не только для уменьшенной меры.

Это правило расщепления хоть и не встречается в работе \cite{bansal99} в точно таком же виде, но по сути является обобщением нескольких однотипных правил, встречающихся там.

\subsection{Выводы}
\label{subsec:measure:summary}

\begin{itemize}
 \item Предложена новая уменьшенная мера $d = L - n_3$, позволяющая сгладить разницу свойств 3-переменных и остальных переменных.
 \item Продемонстрировано, что для простого расщепления по переменной с хотя бы четырьмя вхождениями в мере $d$ вектор расщепления получается не хуже, чем для длины формулы (лемма \ref{lemma:measure:branch-on}).
 \item Введено правило расщепления для $6^+$-переменной с вектором расщепления $(6,10)$ в худшем случае.
\end{itemize}

% vim: spell spelllang=ru_yo,en_gb
